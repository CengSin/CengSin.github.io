<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>CengSin PERSONAL BLOG | 使用rand7实现rand10</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.148.1"><meta name=ROBOTS content="INDEX, FOLLOW"><link href=/dist/app.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css integrity=sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js integrity=sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><script>(function(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(e)}),i.parentNode.insertBefore(n,i)})("/lib/pangu.min.js",function(){pangu.spacingPage()})</script><style type=text/css media="screen, print">@font-face{font-family:fancytitlefont;font-style:normal;font-display:swap;src:url(%25!s%28%3cnil%3e%29.woff2)format('woff2'),url(%25!s%28%3cnil%3e%29.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:300;font-display:swap;src:local('Noto Serif CJK SC Light'),local('NotoSerifCJK-Light'),url(/fonts/noto-serif-sc-v7-latin_chinese-simplified-300.woff2)format('woff2'),url(/fonts/noto-serif-sc-v7-latin_chinese-simplified-300.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:400;font-display:swap;src:local('Noto Serif CJK SC'),local('NotoSerifCJK-Regular'),url(/fonts/noto-serif-sc-v7-latin_chinese-simplified-regular.woff2)format('woff2'),url(/fonts/noto-serif-sc-v7-latin_chinese-simplified-regular.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:500;font-display:swap;src:local('Noto Serif CJK SC Medium'),local('NotoSerifCJK-Medium'),url(/fonts/noto-serif-sc-v7-latin_chinese-simplified-500.woff2)format('woff2'),url(/fonts/noto-serif-sc-v7-latin_chinese-simplified-500.woff)format('woff')}</style></head><body class="bg-gray-100 text-gray-700 font-sans"><div class="p-6 sm:p-10 md:p-16 flex flex-wrap"><header class="w-full md:w-2/5 xl:w-1/2 md:pr-12 lg:pr-20 xl:pr-24 order-1 md:order-1 max-w-2xl"><div class="z-50 bg-gray-100 bg-opacity-75 bg-opacity-custom lg:min-w-0.7 max-w-xl md:float-right md:text-right leading-loose tracking-tight md:sticky md:top-0 pt-2"><div><h2><a href=/ title="CengSin PERSONAL BLOG" class="heading font-cursive icon">CengSin PERSONAL BLOG</a></h2></div><h1 class=pt-2>使用rand7实现rand10</h1><div class="flex flex-wrap justify-end pt-2"><div class="md:flex-grow-0 font-light"></div><time class="text-eucalyptus-500 md:text-right md:flex-grow font-light pl-4" datetime=2021-09-05T14:50:20+08:00>2021-9-5 14:50</time></div><hr></div></header><main role=main class="w-full md:w-3/5 xl:w-1/2 max-w-3xl order-2 md:order-2 min-h-70vh pt-2 pb-4"><article><section class="mx-auto content"><div class=c-rich-text><h1 id=使用rand7实现rand10>使用rand7实现rand10</h1><p>题目：</p><pre tabindex=0><code>已有方法 rand7 可生成 1 到 7 范围内的均匀随机整数，试写一个方法 rand10 生成 1 到 10 范围内的均匀随机整数。

不要使用系统的 Math.random() 方法。



来源：力扣（LeetCode）
链接：https://leetcode-cn.com/problems/implement-rand10-using-rand7
著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。
</code></pre><p>结论：</p><ol><li>(RAND_X - 1) * Y + RAND_Y = RAND_X*Y</li><li>RAND_X*Y % Y + 1 = RAND_Y</li></ol><p>证明结论1：</p><p>使用rand2生成rand4</p><p>使用 rand2_Row + rand2_Col 生成的随机数为：</p><table><thead><tr><th>Col\Row</th><th>1</th><th>2</th></tr></thead><tbody><tr><td>1</td><td>2</td><td>3</td></tr><tr><td>2</td><td>3</td><td>4</td></tr></tbody></table><p>结果生成的范围为[2,4]</p><p>然后我们缩小结果的范围，用 rand2_Row - 1 替换 原来式子中的 rand2_Row，上面的式子就变成了：(rand2_Row - 1) + rand2_Col</p><table><thead><tr><th>Col\Row</th><th>0</th><th>1</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>2</td></tr><tr><td>2</td><td>2</td><td>3</td></tr></tbody></table><p>结果生成的范围为[1,3]。但显然结果出现的概论并不是平均的，1，3的概率分别为25%，2的概率最大，为50%。</p><p>之后我们使用 (rand2_Row - 1) * 2 + rand2_Col</p><table><thead><tr><th>Col\Row</th><th>0</th><th>1</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>3</td></tr><tr><td>2</td><td>2</td><td>4</td></tr></tbody></table><p>(1,2,3,4)出现的结果为均衡的概率。</p><p>之后将结论带入(rand2 - 1) * 3 + rand3 == rand6</p><table><thead><tr><th>Col\Row</th><th>0</th><th>1</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>4</td></tr><tr><td>2</td><td>2</td><td>5</td></tr><tr><td>3</td><td>3</td><td>6</td></tr></tbody></table><p>证明结论2：</p><p>rand4 % 2 + 1 = rand2</p><ul><li>1 % 2 + 1 = 2</li><li>2 % 2 + 1 = 1</li><li>3 % 2 + 1 = 2</li><li>4 % 2 + 1 = 1</li></ul><p>题目：</p><p>使用rand7生成rand10</p><p>我们可以使用第一个结论</p><p>(rand7 - 1) * 7 + rand7 = rand49</p><p>因为rand49不是rand10的倍数，所以我们要抛弃[41, 49]之间的数字：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>rand10</span>() <span style=color:#66d9ef>int</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>num</span> <span style=color:#f92672>:=</span> (<span style=color:#a6e22e>rand7</span>() <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>rand7</span>()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>num</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>40</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>num</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>这种结论的最坏情况可能会超时，num > 40。所以进行优化，缩小不属于10的整数倍的范围：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>rand10</span>() <span style=color:#66d9ef>int</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>num</span> <span style=color:#f92672>:=</span> (<span style=color:#a6e22e>rand7</span>() <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>rand7</span>() <span style=color:#75715e>// rand49</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>num</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>40</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>num</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>a</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>num</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>40</span> <span style=color:#75715e>// rand9</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>b</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>rand7</span>()
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>num</span> = (<span style=color:#a6e22e>a</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>b</span> <span style=color:#75715e>// rand63</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>num</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>60</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>num</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>a</span> = <span style=color:#a6e22e>num</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>60</span> <span style=color:#75715e>// rand3</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>b</span> = <span style=color:#a6e22e>rand7</span>()
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>num</span> = (<span style=color:#a6e22e>a</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>b</span> <span style=color:#75715e>// rand21</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>num</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>20</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>num</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></section></article></main><div class="w-full h-0 flex-none order-3"></div><aside role=contentinfo class="w-full md:w-2/5 xl:w-1/2 md:pr-12 lg:pr-20 xl:pr-24 order-4 md:order-3 md:sticky md:bottom-0 self-end max-w-2xl"><div class="md:float-right md:text-right leading-loose tracking-tight md:mb-2"><div class="md:max-w-xs flex flex-col md:items-end"><ul class="font-serif flex-grow-0 flex justify-between flex-wrap md:flex-col"><li class="px-1 md:px-0"><a href=/posts/ title="文章 page" class="font-medium text-medium-red-violet-600 hover:text-medium-red-violet-400">文章</a></li><li class="px-1 md:px-0"><a href=/tags/ title="标签 page">标签</a></li></ul><div class="text-sm text-gray-500 leading-tight a-gray"><br>Built with Hugo and theme <a href=https://github.com/heyeshuang/hugo-theme-tokiwa>Tokiwa</a>. 294 words in this page.</div></div></div></aside><footer class="w-full md:w-3/5 xl:w-1/2 order-3 max-w-3xl md:order-4 pt-2"><hr class=double-line><div class="flex flex-wrap justify-between pb-2 leading-loose font-serif"><a class=flex-grow-0 href=/posts/readme/><svg class="fill-current inline-block h-4 w-4" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z"/></svg>
</a><a class=flex-grow-0 href=/posts/non_negative_integers_without_consecutive_ones/>不包含连续的1的整数
<svg class="fill-current inline-block h-4 w-4" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.172 11l-5.364-5.364 1.414-1.414L20 12l-7.778 7.778-1.414-1.414L16.172 13H4v-2z"/></svg></a></div><div></div><hr><div class=pb-2></div><hr></footer><script src=/dist/app.js></script></div></body></html>